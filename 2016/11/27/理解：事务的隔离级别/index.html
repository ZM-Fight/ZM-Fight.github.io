<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="梦工厂"><title>理解：事务的隔离级别 | 梦工厂's blog</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.1"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">理解：事务的隔离级别</h1><a id="logo" href="/.">梦工厂's blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">理解：事务的隔离级别</h1><div class="post-meta">Nov 27, 2016<span> | </span><span class="category"><a href="/categories/数据库/">数据库</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#一、数据库事务的ACID属性"><span class="toc-number">1.</span> <span class="toc-text">一、数据库事务的ACID属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#二、事务的隔离级别"><span class="toc-number">2.</span> <span class="toc-text">二、事务的隔离级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#三、读写异常"><span class="toc-number">3.</span> <span class="toc-text">三、读写异常</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#四、事务隔离级别与读写异常的关系"><span class="toc-number">4.</span> <span class="toc-text">四、事务隔离级别与读写异常的关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#五、MYSQL实践演示"><span class="toc-number">5.</span> <span class="toc-text">五、MYSQL实践演示</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#（1）演示隔离级别：读未提交"><span class="toc-number">5.1.</span> <span class="toc-text">（1）演示隔离级别：读未提交</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（2）演示隔离级别：读已提交"><span class="toc-number">5.2.</span> <span class="toc-text">（2）演示隔离级别：读已提交</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（3）演示隔离级别：可重复读"><span class="toc-number">5.3.</span> <span class="toc-text">（3）演示隔离级别：可重复读</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#（4）演示隔离级别：可串行化"><span class="toc-number">5.4.</span> <span class="toc-text">（4）演示隔离级别：可串行化</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#六、MYSQL隔离级别与实现"><span class="toc-number">6.</span> <span class="toc-text">六、MYSQL隔离级别与实现</span></a></li></ol></div></div><div class="post-content"><h4 id="一、数据库事务的ACID属性"><a href="#一、数据库事务的ACID属性" class="headerlink" title="一、数据库事务的ACID属性"></a>一、数据库事务的ACID属性</h4><ul>
<li>原子性：事务的所有操作要么全部执行，要么全部不执行；</li>
<li>一致性：事务作为原子从一个一致的数据库状态开始独立的运行，则事务结束时事务也必须再次是一致的；</li>
<li>隔离性：多个事务可能并发执行，但是系统保证，对于任意一对事务T1,T2，在T1看来，T2或者在T1开始之前已经完成执行，或者在T1完成之后开始执行。因此，每个事务都感觉不到系统中有其他事务在并发的执行。</li>
<li>持久性：一个事务成功完成后，它对数据库的改变必须是永久的，即使出现系统故障。</li>
</ul>
<h4 id="二、事务的隔离级别"><a href="#二、事务的隔离级别" class="headerlink" title="二、事务的隔离级别"></a>二、事务的隔离级别</h4><p>为了性能考虑，数据库会允许使用者选择牺牲隔离性来换取并发度。<br>SQL定义的四种隔离级别：</p>
<ul>
<li>读未提交（Read Uncommitted）：读取未提交的数据，即其他事务已经修改但是还未提交的数据，这是最低的隔离级别；</li>
<li>读已提交（Read Committed）：读取已提交的数据，但不要求可重复读。<br>例如，在事务两次读取一个数据项期间，另一个事务更新了该数据并提交；</li>
<li>可重复读（Repeatable）：读取已提交的数据，保证可重复读。<br>在一个事务中，对同一个数据项，确保前后读取的数据结果一样；</li>
<li>可串行化（Serializable）：事务是可串行化执行的，就像一个事务执行的时候没有别的事务在同时执行，这是最高的隔离级别；</li>
</ul>
<h4 id="三、读写异常"><a href="#三、读写异常" class="headerlink" title="三、读写异常"></a>三、读写异常</h4><p>事务隔离级别降低产生的并发问题：</p>
<ul>
<li>脏读（Dirty Reads）：一个事务读取了另外一个事务更新却<strong>还没有提交</strong>的数据；<br>例如，事务A看到了被事务B回滚掉的数据。</li>
<li>不可重复读（Non-Repeatable Reads）：一个事务对同一个数据项的多次读取可能会产生不同的结果，即：一个事务读取了另一个事务更新前后的数据；<br>例如，事务A在T1时间读取数据项，事务B在T2时间修改数据项并提交事务，事务A在T3时间再次读取数据项时发现数据改变。</li>
<li>幻读（Phantom Reads）：一个事务读到了另一个事务插进来的数据；<br>一个事务用Where子句来检索一个表的数据，另一个事务插入一条新的记录，并且符合Where条件，这样，第一个事务用同一个where条件来检索数据后，就会多出一条记录。</li>
</ul>
<p>不可重复读与幻读的区分：</p>
<ul>
<li>不可重复读的重点是数据修改<br>同样的条件, 你读取过的数据,再次读取出来发现值不一样了</li>
<li>幻读的重点在于新增或者删除<br>同样的条件, 第 1 次和第 2 次读出来的记录数不一样</li>
</ul>
<h4 id="四、事务隔离级别与读写异常的关系"><a href="#四、事务隔离级别与读写异常的关系" class="headerlink" title="四、事务隔离级别与读写异常的关系"></a>四、事务隔离级别与读写异常的关系</h4><table>
<thead>
<tr>
<th style="text-align:left">隔离解别  \  读写异常</th>
<th style="text-align:center">脏读</th>
<th style="text-align:center">不可重复读</th>
<th style="text-align:center">幻读</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">读未提交</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td style="text-align:left">读已提交</td>
<td style="text-align:center">N</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td style="text-align:left">可重复读</td>
<td style="text-align:center">N</td>
<td style="text-align:center">N</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td style="text-align:left">可串行化</td>
<td style="text-align:center">N</td>
<td style="text-align:center">N</td>
<td style="text-align:center">N</td>
</tr>
</tbody>
</table>
<p>（Y表示会出现，N表示不会出现）</p>
<h4 id="五、MYSQL实践演示"><a href="#五、MYSQL实践演示" class="headerlink" title="五、MYSQL实践演示"></a>五、MYSQL实践演示</h4><ul>
<li><p>mysql版本号：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select version();</div><div class="line">+------------+</div><div class="line">| version()  |</div><div class="line">+------------+</div><div class="line">| 5.7.14-log |</div><div class="line">+------------+</div></pre></td></tr></table></figure>
</li>
<li><p>查看InnoDB存储引擎 系统级的隔离级别 和 会话级的隔离级别 </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select @@global.tx_isolation,@@tx_isolation;</div><div class="line">+-----------------------+-----------------+</div><div class="line">| @@global.tx_isolation | @@tx_isolation  |</div><div class="line">+-----------------------+-----------------+</div><div class="line">| REPEATABLE-READ       | REPEATABLE-READ |</div><div class="line">+-----------------------+-----------------+</div></pre></td></tr></table></figure>
<ol>
<li>Mysql/InnoDB提供的默认隔离级别为可重复读（REPEATABLE-READ）;</li>
<li>用户可以使用SET TRANSACTION语句改变隔离级别：<br><code>SET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}</code><br>注意：<br>(1)默认的行为（不带session和global）是为<strong>下一个（未开始）</strong>事务设置隔离级别。<br>(2)如果你使用GLOBAL关键字，语句在全局对从那点开始创建的所有<strong>新连接</strong>（除了不存在的连接）设置默认事务级别。<br>(3)使用SESSION 关键字为<strong>将来在当前连接上</strong>执行的事务设置默认事务级别。<br>任何客户端都能自由改变会话隔离级别（甚至在事务的中间），或者为下一个事务设置隔离级别。 </li>
</ol>
</li>
<li><p>关闭SQL语句的自动提交</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Session 1,Session 2:</div><div class="line"></div><div class="line">mysql&gt; set autocommit=0;</div><div class="line"></div><div class="line">mysql&gt; show variables like 'autocommit';</div><div class="line">+---------------+-------+</div><div class="line">| Variable_name | Value |</div><div class="line">+---------------+-------+</div><div class="line">| autocommit    | OFF   |</div><div class="line">+---------------+-------+</div></pre></td></tr></table></figure>
</li>
<li><p>建立实验表</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mysql&gt; create table student(id int(11),name varchar(20),primary key(id));</div><div class="line"></div><div class="line">mysql&gt; show create table student;</div><div class="line">+---------+-------------------------------------------------------------</div><div class="line">------------------------------------------------------------------------</div><div class="line">| Table   | Create Table</div><div class="line"></div><div class="line">+---------+-------------------------------------------------------------</div><div class="line">------------------------------------------------------------------------</div><div class="line">| student | CREATE TABLE `student` (</div><div class="line">  `id` int(11) NOT NULL,</div><div class="line">  `name` varchar(20) DEFAULT NULL,</div><div class="line">  PRIMARY KEY (`id`)</div><div class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8 |</div><div class="line">+---------+-------------------------------------------------------------</div><div class="line">------------------------------------------------------------------------</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="（1）演示隔离级别：读未提交"><a href="#（1）演示隔离级别：读未提交" class="headerlink" title="（1）演示隔离级别：读未提交"></a>（1）演示隔离级别：读未提交</h5><p>更改系统级别：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Session 1:  </div><div class="line">mysql&gt; set session tx_isolation='read-uncommitted';</div><div class="line">mysql&gt; select @@global.tx_isolation,@@tx_isolation;</div><div class="line">+-----------------------+------------------+</div><div class="line">| @@global.tx_isolation | @@tx_isolation   |</div><div class="line">+-----------------------+------------------+</div><div class="line">| REPEATABLE-READ      | READ-UNCOMMITTED |</div><div class="line">+-----------------------+------------------+</div><div class="line"></div><div class="line">Session 2: </div><div class="line">mysql&gt; set session tx_isolation='read-uncommitted';</div><div class="line">mysql&gt; select @@global.tx_isolation,@@tx_isolation;</div><div class="line">+-----------------------+-----------------+</div><div class="line">| @@global.tx_isolation | @@tx_isolation  |</div><div class="line">+-----------------------+-----------------+</div><div class="line">| REPEATABLE-READ      | READ-UNCOMMITTED |</div><div class="line">+-----------------------+-----------------+</div></pre></td></tr></table></figure></p>
<p>演示脏读：事务A读取了事务B回滚的数据<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">Session 1:                              Session 2:</div><div class="line">mysql&gt; start transaction;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">                                        mysql&gt; start transaction;</div><div class="line">                                        Query OK, 0 rows affected (0.00 sec)</div><div class="line">                                        mysql&gt; insert into student values(1,"Tom");</div><div class="line">                                        Query OK, 1 row affected (0.10 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from student;</div><div class="line">+----+------+</div><div class="line">| id | name |</div><div class="line">+----+------+</div><div class="line">|  1 | Tom  |</div><div class="line">+----+------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">                                        mysql&gt; rollback;</div><div class="line">                                        Query OK, 0 rows affected (0.12 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>隔离级别为读未提交时，会出现脏读、不可重复读、幻读的情况；</p>
<h5 id="（2）演示隔离级别：读已提交"><a href="#（2）演示隔离级别：读已提交" class="headerlink" title="（2）演示隔离级别：读已提交"></a>（2）演示隔离级别：读已提交</h5><p>更改系统级别：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Session 1: </div><div class="line">mysql&gt; set session tx_isolation='read-committed';</div><div class="line">mysql&gt; select @@global.tx_isolation,@@tx_isolation;</div><div class="line">+-----------------------+-----------------+</div><div class="line">| @@global.tx_isolation | @@tx_isolation  |</div><div class="line">+-----------------------+-----------------+</div><div class="line">| REPEATABLE-READ        | READ-COMMITTED |</div><div class="line">+-----------------------+-----------------+</div><div class="line"></div><div class="line">Session 2:</div><div class="line">mysql&gt; set session tx_isolation='read-committed';</div><div class="line">mysql&gt; select @@global.tx_isolation,@@tx_isolation;</div><div class="line">+-----------------------+-----------------+</div><div class="line">| @@global.tx_isolation | @@tx_isolation  |</div><div class="line">+-----------------------+-----------------+</div><div class="line">| REPEATABLE-READ        | READ-COMMITTED |</div><div class="line">+-----------------------+-----------------+</div></pre></td></tr></table></figure></p>
<p>脏读可以避免：只可以读取已提交的数据。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Session 1:                              Session 2:</div><div class="line">mysql&gt; start transaction;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">                                        mysql&gt; start transaction;</div><div class="line">                                        Query OK, 0 rows affected (0.00 sec)</div><div class="line">                                        mysql&gt; insert into student values(1,"Tom");</div><div class="line">                                        Query OK, 1 row affected (0.10 sec)</div><div class="line">                                        mysql&gt; select * from student;</div><div class="line">                                        +----+------+</div><div class="line">                                        | id | name |</div><div class="line">                                        +----+------+</div><div class="line">                                        |  1 | Tom  |</div><div class="line">                                        +----+------+</div><div class="line">                                        1 row in set (0.00 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">                                        mysql&gt; rollback;</div><div class="line">                                        Query OK, 0 rows affected (0.12 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>演示不可重复读：一个事务可以读取另一个事务更新前和更新后（提交）的数据；<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">Session 1:                              Session 2:</div><div class="line">mysql&gt; start transaction;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">                                        mysql&gt; start transaction;</div><div class="line">                                        Query OK, 0 rows affected (0.00 sec)</div><div class="line">                                        mysql&gt; insert into student values(1,"Tom");</div><div class="line">                                        Query OK, 1 row affected (0.06 sec)</div><div class="line">                                        mysql&gt; commit;</div><div class="line">                                        Query OK, 0 rows affected (0.08 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">+----+------+</div><div class="line">| id | name |</div><div class="line">+----+------+</div><div class="line">|  1 | Tom  |</div><div class="line">+----+------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line">mysql&gt; commit;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>隔离级别为读已提交时，避免了脏读，会出现不可重复读、幻读的情况；</p>
<h5 id="（3）演示隔离级别：可重复读"><a href="#（3）演示隔离级别：可重复读" class="headerlink" title="（3）演示隔离级别：可重复读"></a>（3）演示隔离级别：可重复读</h5><p>更改系统级别：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Session 1: </div><div class="line">mysql&gt; set session tx_isolation='repeatable-read';</div><div class="line">mysql&gt; select @@global.tx_isolation,@@tx_isolation;</div><div class="line">+-----------------------+-----------------+</div><div class="line">| @@global.tx_isolation | @@tx_isolation  |</div><div class="line">+-----------------------+-----------------+</div><div class="line">| REPEATABLE-READ        | REPEATABLE-READ |</div><div class="line">+-----------------------+-----------------+</div><div class="line"></div><div class="line">Session 2:</div><div class="line">mysql&gt; set session tx_isolation='repeatable-read';</div><div class="line">mysql&gt; select @@global.tx_isolation,@@tx_isolation;</div><div class="line">+-----------------------+-----------------+</div><div class="line">| @@global.tx_isolation | @@tx_isolation  |</div><div class="line">+-----------------------+-----------------+</div><div class="line">| REPEATABLE-READ        | REPEATABLE-READ |</div><div class="line">+-----------------------+-----------------+</div></pre></td></tr></table></figure></p>
<p>不可重复读可以避免：一个事务中读取的数据始终一致。<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Session 1:                              Session 2:</div><div class="line">mysql&gt; start transaction;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">                                        mysql&gt; start transaction;</div><div class="line">                                        Query OK, 0 rows affected (0.00 sec)</div><div class="line">                                        mysql&gt; insert into student values(1,"Tom");</div><div class="line">                                        Query OK, 1 row affected (0.06 sec)</div><div class="line">                                        mysql&gt; commit;</div><div class="line">                                        Query OK, 0 rows affected (0.08 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">mysql&gt; commit;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>演示幻读：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Session 1: </div><div class="line">mysql&gt; start transaction;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">                                        mysql&gt; start transaction;</div><div class="line">                                        Query OK, 0 rows affected (0.00 sec)</div><div class="line">                                        mysql&gt; insert into student values(1,"Tom");</div><div class="line">                                        Query OK, 1 row affected (0.00 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">                                        mysql&gt; commit;</div><div class="line">                                        Query OK, 0 rows affected (0.09 sec)</div><div class="line">mysql&gt; select * from student;</div><div class="line">Empty set (0.00 sec)</div><div class="line">mysql&gt; insert into student values(1,"Tom");</div><div class="line">ERROR 1062 (23000): Duplicate entry '1' for key 'PRIMARY'</div><div class="line"></div><div class="line">查询student为空表，插入数据时却发现已经有数据。</div></pre></td></tr></table></figure></p>
<p>隔离级别为可重复读时，避免了脏读、不可重复读，会出现幻读的情况；</p>
<h5 id="（4）演示隔离级别：可串行化"><a href="#（4）演示隔离级别：可串行化" class="headerlink" title="（4）演示隔离级别：可串行化"></a>（4）演示隔离级别：可串行化</h5><p>隔离级别为可串行化时，可以避免脏读、不可重复读和幻读的情况；代价是并发度最低；</p>
<h4 id="六、MYSQL隔离级别与实现"><a href="#六、MYSQL隔离级别与实现" class="headerlink" title="六、MYSQL隔离级别与实现"></a>六、MYSQL隔离级别与实现</h4><p>参考文章：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAxOTc0NzExNg==&amp;mid=2665513435&amp;idx=1&amp;sn=41ffb114be4a5b53de87831b9c8427bf" target="_blank" rel="external">形象化理解：隔离级别与加锁的程度的关系</a></li>
<li><a href="http://hedengcheng.com/?p=771" target="_blank" rel="external">MySQL 加锁处理分析</a></li>
<li><a href="http://tech.meituan.com/innodb-lock.html" target="_blank" rel="external">Innodb中的事务隔离级别和锁的关系</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_499740cb0100ugs7.html" target="_blank" rel="external">MySQL的InnoDB的幻读问题</a></li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=0.0.1" async></script><a data-url="http://yoursite.com/2016/11/27/理解：事务的隔离级别/" data-id="cizlhfh1k000i3t371tryul23" class="article-share-link">分享到</a><div class="tags"><a href="/tags/总结/">总结</a></div><div class="post-nav"><a href="/2016/11/28/论文阅读笔记 - Spanner/" class="pre">论文阅读笔记 ： Spanner</a><a href="/2016/11/24/分布式数据库知识体系/" class="next">分布式数据库知识体系</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="http://yoursite.com"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/分布式/">分布式</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/博客/">博客</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/每周工作/">每周工作</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法-数据结构/">算法&数据结构</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/论文笔记/" style="font-size: 15px;">论文笔记</a> <a href="/tags/资料/" style="font-size: 15px;">资料</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/博客/" style="font-size: 15px;">博客</a> <a href="/tags/教程/" style="font-size: 15px;">教程</a> <a href="/tags/true/" style="font-size: 15px;">true</a> <a href="/tags/总结/" style="font-size: 15px;">总结</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/Machine-Learning/">Machine Learning</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/04/论文阅读笔记 - Megastore/">论文阅读笔记 ： Megastore</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/每周工作16-11-28/">每周工作 16.11.28</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/论文阅读笔记 - BigTable/">论文阅读笔记 ： BigTable</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/28/论文阅读笔记 - Spanner/">论文阅读笔记 ： Spanner</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/27/理解：事务的隔离级别/">理解：事务的隔离级别</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/24/分布式数据库知识体系/">分布式数据库知识体系</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/21/每周工作 16.11.21/">每周工作 2016-11-21</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/14/每周工作 16.11.14/">每周工作 2016-11-14</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/12/论文阅读笔记 - Raft/">论文阅读笔记 ： Raft</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://coolshell.cn/" title="酷壳" target="_blank">酷壳</a><ul></ul><a href="http://qifuguang.me/" title="同主题" target="_blank">同主题</a><ul></ul><a href="http://blog.csdn.net/colorant/article/details/8256145" title="云计算/数据库论文阅读笔记（学习，搞一搞）" target="_blank">云计算/数据库论文阅读笔记（学习，搞一搞）</a><ul></ul><a href="http://blog.nosqlfan.com/" title="NoSQLFan" target="_blank">NoSQLFan</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">梦工厂's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.1" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.1"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.1"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.1"></script></div></body></html>